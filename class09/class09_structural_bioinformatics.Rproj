---
title: "Class 9: Structural Bioinformatics pt 1"
author: "Osirus Eisenman"
format: pdf
editor: visual
---

## The PDB Database

The main repository for biomolecular structure data is the Protein Data Bank (PDB) <https://www.rcsb.org/>

Let's have a quick look at the composition of this database:

> **Q1:**Â What percentage of structures in the PDB are solved by X-Ray and Electron Microscopy
>
> A. 81.43%
>
> ```{r}
> stats<-read.csv("Data Export Summary.csv")
> stats
> ```
>
> ```{r}
> n.total<-sum(stats$Total)
> n.xray<-sum(stats$`X-ray`)
> round(n.xray/n.total*100,2)
> ```

```{r}
as.number(sub(",","",stats$X.ray))
```

This is annoying lets try a different import function from the **readr** package.

```{r}
library(readr)
stats<-read_csv("Data Export Summary.csv")
stats
```

> **Q2.** What proportion of structures in the PDB are protein?
>
> A. 86.05
>
> ```{r}
> all_things<-sum(stats$Total)
> just_protein<-stats[1,9]
> round(just_protein/all_things*100,2)
> ```

> **Q3.** Make a bar plot of the data
>
> ```{r}
> library(ggplot2)
> ggplot(stats, aes(x =`Molecular Type`,y=Total, fill = `Molecular Type`)) +
>   geom_col()
> ```

## Visualizing Structure Data

The Mol\* viewer is embedded in many bioinformatics websites. The homepage is <https://molstar.org/>

I can insert any figure or image file using markdown format.

\![The HIV-Pr dimer with bound inhibitor\](1HSG.png)

\![The catalytic ASP25 1HSG Dimer\](1HSG_asp.png)

## Bio3 Package for Structural Bioinformatics

We can use the bio3d package to read and analyze bio-molecular data in R:

```{r}
library(bio3d)

hiv<-read.pdb("1hsg")
hiv
```

```{r}
head(hiv$atom)

```

Let's get the sequence:

```{r}
pdbseq(hiv)
```

Let's trim to chain A and get just it's sequence:

```{r}
chainA<-trim.pdb(hiv,chain="A")
chainA.seq<-pdbseq(chainA)
```

Let's blast:

```{r blast_hiv,cache=TRUE}
blast<- blast.pdb(chainA.seq)
```

Or you can use "#/blast_hiv, cache=TRUE" on a coding line.

```{r}
head(blast$hit.tbl)
```

Plot a quick overview of blast results:

```{r}
hits<-plot(blast)
```

```{r}
hits$pdb.id
```

## Prediction of Functional Motions

We can run a Normal Mode Analysis (NMA) to predict large scale motions/flexibility/dynamics of any bio-molecule that we can read into R.

Let's look at ADK

```{r}
adk<-read.pdb("1adk")

adk_A<-trim.pdb(adk,chain="A")
adk_A
```

```{r}
m<-nma(adk_A)
plot(m)
```

Let's write out a "trajectory" of predicted motion

```{r}
mktrj(m,file="adk_nma.pdb")
```

## Play with 3D Viewing in R

We can use the new **bio3dview** package, which is not yet on CRAN, to render interactive 3D views in R and HTML quarto output reports.

To install from GitHub we can use the **pak** package.

```{r}
library(bio3dview)
#view.pdb(adk)
```
